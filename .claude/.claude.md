# Complete 365 Tenant Creation

## Project Overview
This repository contains a comprehensive Microsoft 365 tenant automation suite built with PowerShell 7. It provides a centralized menu-driven system for configuring various M365 services including Entra ID, Intune, Exchange Online, SharePoint, Security & Defender, and Purview Compliance.

## Architecture
The project follows a modular architecture with:
- **Main-Menu.ps1**: Central hub that dynamically downloads and executes scripts from GitHub
- **Service-specific folders**: Organized by M365 service (Entra, Intune, Exchange, SharePoint)
- **Prerequisite checking**: Built-in dependency validation to ensure proper configuration order

## Key Components

### Main Menu System (`Main-Menu.ps1`)
- PowerShell 7 requirement with automatic module installation
- Dynamic script downloading from GitHub repository
- Service-specific scope management for Microsoft Graph permissions
- Real-time prerequisite checking and menu state updates
- Caching system for downloaded scripts

### Service Categories

#### Entra ID (`/entra/`)
- **Security-Groups.ps1**: Dynamic security group creation
- **CA-Policies.ps1**: Conditional Access policy configuration
- **Admin-Creation.ps1**: Administrative account setup
- **User-Creation.ps1**: User management and provisioning

#### Intune (`/Intune/`)
- **Device-Groups.ps1**: OS-based device group creation
- **Configuration-Policies.ps1**: Device configuration management
- **Compliance-Policies.ps1**: Device compliance requirements
- **AllPolicies_Complete.json**: Comprehensive policy definitions

#### Exchange Online (`/Exchange/`)
- **Shared-MB-Creation.ps1**: Shared mailbox management
- **Archive-Policies.ps1**: Email archiving configuration
- **Distribution-Lists.ps1**: Email distribution management
- **Mail-Flow-Rules.ps1**: Email routing and filtering

#### SharePoint (`/SharePoint/`)
- **Site-Creation.ps1**: Site collection provisioning

## Prerequisites and Dependencies
The system enforces a logical configuration order:
1. **Security Groups** (foundational) → Required for most other services
2. **Device Groups** → Required for Intune policies
3. **Conditional Access** → Requires Security Groups
4. **Compliance Policies** → Requires Device Groups
5. **Administrative Accounts** → Requires Security Groups

## Technical Requirements
- PowerShell 7.0+
- Microsoft Graph PowerShell modules (auto-installed)
- Appropriate Microsoft 365 administrative permissions
- Internet connectivity for GitHub script downloads

## Authentication & Permissions
Uses Microsoft Graph with service-specific scope management:
- **Entra**: User/Group management, Conditional Access, Directory operations
- **Intune**: Device management, Configuration policies, App deployment
- **Exchange**: Group management, Directory operations
- **SharePoint**: Sites management, Group operations
- **Security**: Security actions and policies
- **Purview**: Information protection and records management

## Usage Pattern
1. Run `Main-Menu.ps1` to start the automation hub
2. Connect to Microsoft 365 tenant (option 8)
3. Navigate through service menus in logical order
4. System prevents configuration of services without prerequisites
5. Real-time status updates show completion progress

## Development Notes
- Scripts are dynamically downloaded from GitHub for always-current versions
- Caching system improves performance on repeat executions
- Error handling with detailed logging throughout
- Modular design allows independent service configuration
- Built-in validation prevents configuration conflicts

## Authors
CB & Claude Partnership - BITS 365 Automation v1.0